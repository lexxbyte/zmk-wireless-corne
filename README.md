# Corne ZMK Configuration

**This keyboard is not the same as [foostan's Corne](https://github.com/foostan/crkbd). It will not work with standard `corne` firmware.**

## Setup Instructions

1. Fork this repository
2. Enable GitHub Actions in your forked repository
3. Navigate to Actions tab and enable workflows
4. Edit files manually and commit them or use [keymap editor](https://nickcoutsos.github.io/keymap-editor/)

## Keymap Diagram

![Diagram of config/corne.keymap](keymap-drawer/corne.svg "generated by @caksoylar's Keymap Drawer")

## Building Firmware Locally

### Set-up local enviroment

1. Create a new virtual environment:

```bash
python3 -m venv .venv
```

2. Activate the virtual environment:

```bash
source .venv/bin/activate
```

3. Install west:

```bash
pip install west
```

4. Initialize the application and update to fetch modules, including Zephyr:

```bash
west init -l config
west update
```

5. Export a Zephyr CMake package. This allows CMake to automatically load boilerplate code required for building Zephyr applications.

```bash
west zephyr-export
```

6. Install the additional dependencies found in Zephyr's requirements-base.txt:

```bash
pip install -r zephyr/scripts/requirements-base.txt
```

7. [ Install Zephyr SDK. ](https://docs.zephyrproject.org/3.5.0/develop/getting_started/index.html#install-zephyr-sdk)

### Build Left

```bash
west build -s zmk/app -d build/left -b "corne_left" -- -DSHIELD="nice_view" -DZMK_EXTRA_MODULES="<absolute-path>/zmk-wireless-corne/zephyr" -DZMK_CONFIG="<absolute-path>/zmk-wireless-corne/config"
```

### Build Right

```bash
west build -s zmk/app -d build/right -b "corne_right" -- -DSHIELD="nice_view" -DZMK_EXTRA_MODULES="<absolute-path>/zmk-wireless-corne/zephyr" -DZMK_CONFIG="<absolute-path>/zmk-wireless-corne/config"
```

### Move Compiled firmware to build folder

```bash
mv build/left/zephyr/zmk.uf2 build/nice_left
mv build/right/zephyr/zmk.uf2 build/nice_right
```

### Troubleshooting Common Issues

#### Missing `elftools` Package

If you encounter an error related to missing `elftools`, follow these steps:

1. Install the required package (it might say it is already installed but proceed with next step):

   ```bash
   pip install pyelftools
   ```

2. Activate your Python virtual environment again (for some reason this fixes it):

   ```bash
   source .venv/bin/activate
   ```
